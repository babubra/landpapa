# –ö–æ–Ω—Ç–µ–∫—Å—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –ª–æ–∫–∞—Ü–∏–π

> **–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2026-02-03

## ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ: –ü–æ–ª–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤ –Ω–∞ SmartLocationFilter

### –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

**–§–∞–π–ª:** `kaliningrad-land/src/components/filters/SmartLocationFilter.tsx`

–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Ñ–∏–ª—å—Ç—Ä–∞ –ª–æ–∫–∞—Ü–∏–π —Å:

1. **–°—Ç—Ä–æ–∫–∞ –ø–æ–∏—Å–∫–∞** ‚Äî –∂–∏–≤–æ–π –ø–æ–∏—Å–∫ –ø–æ API `/api/locations/search`
   - Debounce 300ms
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–∏–ø (–≥–æ—Ä–æ–¥/—Ä–∞–π–æ–Ω/–Ω.–ø.) –∏ –∏–µ—Ä–∞—Ä—Ö–∏—é
   - –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: `sort_order DESC` ‚Üí —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å ‚Üí –∞–ª—Ñ–∞–≤–∏—Ç

2. **–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ** ‚Äî –≤—ã–±–æ—Ä —Ä–∞–π–æ–Ω–∞/–≥–æ—Ä–æ–¥–∞ –∏–∑ —Å–ø–∏—Å–∫–∞
   - 3 –∫–æ–ª–æ–Ω–∫–∏ –Ω–∞ –¥–µ—Å–∫—Ç–æ–ø–µ
   - –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: `sort_order DESC` ‚Üí –∞–ª—Ñ–∞–≤–∏—Ç
   - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ª–æ–∫–∞—Ü–∏–π –±–µ–∑ –æ–±—ä—è–≤–ª–µ–Ω–∏–π (`min_listings=1`)
   - –ò–∫–æ–Ω–∫–∏: üèôÔ∏è –≥–æ—Ä–æ–¥–∞, üìç —Ä–∞–π–æ–Ω—ã

3. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å URL**
   - –ü—Ä–∏ –≤—ã–±–æ—Ä–µ –ª–æ–∫–∞—Ü–∏–∏ ‚Üí –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –≥–µ–æ-URL –∏–ª–∏ `?location_id=X`
   - –ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∏–∑ `geoLocation.locationId` –∏–ª–∏ URL params

### ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ –≤–æ –≤—Å–µ —Ñ–∏–ª—å—Ç—Ä—ã

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ü—É—Ç—å | –°—Ç–∞—Ç—É—Å |
|-----------|------|--------|
| `MapFilters.tsx` | `/map` | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å `location_id` |
| `CatalogFilters.tsx` | `/catalog`, `/{geo}` | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å –≥–µ–æ-URL –∏ `locationId` |
| `SearchFilter.tsx` | –ì–ª–∞–≤–Ω–∞—è `/` | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å –≥–µ–æ-URL –∏ `location_id` |

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

1. **Canonical URL** ‚Äî —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç slugs –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `locations` (–Ω–µ `District/Settlement`)
2. **Breadcrumbs** ‚Äî –∏—Å–ø–æ–ª—å–∑—É—é—Ç slugs –∏–∑ `locationNew` 
3. **ListingPageContent** ‚Äî —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç `geoLocation` –∏–∑ –Ω–æ–≤–æ–π –∏–µ—Ä–∞—Ä—Ö–∏–∏
4. **`/api/locations/resolve-new`** ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ single-segment district slugs
5. **`/api/public-plots/count`** ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ `location_id`

---

## üî≤ TODO: –ü–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç –∏ –¥–µ–ø—Ä–µ–∫–∞—Ü–∏—è —Å—Ç–∞—Ä–æ–π –∞–¥—Ä–µ—Å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

### –¶–µ–ª—å

–ü–æ–ª–Ω–æ—Å—Ç—å—é –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å—Ç–∞—Ä—ã—Ö —Ç–∞–±–ª–∏—Ü `District`, `Settlement` –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ `settlement_id`, `district_id` –Ω–∞ —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—É—é –º–æ–¥–µ–ª—å `Location` (—Ç–∞–±–ª–∏—Ü–∞ `locations`) —Å –µ–¥–∏–Ω—ã–º `location_id`.

### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: –î–≤–æ–π–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞

–°–µ–π—á–∞—Å —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ **—Ä–µ–∂–∏–º–µ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏**: 
- –ù–æ–≤—ã–π –∫–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `location_id` –∏ —Ç–∞–±–ª–∏—Ü—É `locations`
- –°—Ç–∞—Ä—ã–π –∫–æ–¥ –≤—Å—ë –µ—â—ë –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `settlement_id`, `district_id` –∏ —Ç–∞–±–ª–∏—Ü—ã `District`, `Settlement`
- API –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç fallback –º–µ–∂–¥—É —Å–∏—Å—Ç–µ–º–∞–º–∏

---

## üìã –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞—É–¥–∏—Ç–∞ (2026-02-03)

### Frontend: kaliningrad-land/src/

#### –§–∞–π–ª—ã —Å `settlement_id`

| –§–∞–π–ª | –ü—Ä–∏—á–∏–Ω–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –î–µ–π—Å—Ç–≤–∏–µ |
|------|---------|-----------|----------|
| `app/[...geo]/page.tsx` | Fallback –≤ `ResolvedLocation` –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –∏ `getListingByGeoUrl` | üü° –°—Ä–µ–¥–Ω–∏–π | –£–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ backend |
| `app/catalog/page.tsx` | SSR fallback –ø–∞—Ä–∞–º–µ—Ç—Ä | üü° –°—Ä–µ–¥–Ω–∏–π | –£–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ backend |
| `app/catalog/CatalogContent.tsx` | Fallback –ª–æ–≥–∏–∫–∞ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ `locationId` | üü° –°—Ä–µ–¥–Ω–∏–π | –ú–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å fallback |

#### –§–∞–π–ª—ã —Å `district_id`

| –§–∞–π–ª | –ü—Ä–∏—á–∏–Ω–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –î–µ–π—Å—Ç–≤–∏–µ |
|------|---------|-----------|----------|
| `app/[...geo]/page.tsx` | Fallback –≤ `ResolvedLocation`, –ø—Ä–æ–≤–µ—Ä–∫–∏ | üü° –°—Ä–µ–¥–Ω–∏–π | –£–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ backend |
| `app/map/MapPageContent.tsx` | –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∫–æ–¥? | üü¢ –ù–∏–∑–∫–∏–π | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å |
| `app/catalog/page.tsx` | SSR fallback | üü° –°—Ä–µ–¥–Ω–∏–π | –£–¥–∞–ª–∏—Ç—å |
| `app/catalog/CatalogContent.tsx` | Fallback –ª–æ–≥–∏–∫–∞ | üü° –°—Ä–µ–¥–Ω–∏–π | –£–¥–∞–ª–∏—Ç—å fallback |

#### –§–∞–π–ª—ã —Å `settlements=` (—Å—Ç–∞—Ä—ã–π URL —Ñ–æ—Ä–º–∞—Ç)

| –§–∞–π–ª | –ü—Ä–∏—á–∏–Ω–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –î–µ–π—Å—Ç–≤–∏–µ |
|------|---------|-----------|----------|
| `lib/geoUrl.ts` | –°—Ç–∞—Ä–∞—è —Ñ—É–Ω–∫—Ü–∏—è `buildCatalogUrl` | üî¥ –í—ã—Å–æ–∫–∏–π | –£–¥–∞–ª–∏—Ç—å –∏–ª–∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å |
| `components/catalog/CatalogFilters.tsx` | –†–µ–¥–∏—Ä–µ–∫—Ç —Å—Ç–∞—Ä—ã—Ö URL | üü¢ –ù–∏–∑–∫–∏–π | –û—Å—Ç–∞–≤–∏—Ç—å –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ |

#### –°—Ç–∞—Ä—ã–π LocationFilter (—É—Å—Ç–∞—Ä–µ–≤—à–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç)

| –§–∞–π–ª | –°—Ç–∞—Ç—É—Å | –î–µ–π—Å—Ç–≤–∏–µ |
|------|--------|----------|
| `components/filters/LocationFilter.tsx` | ‚ùå –£—Å—Ç–∞—Ä–µ–≤—à–∏–π | –£–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —á—Ç–æ –Ω–∏–≥–¥–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è |
| `components/filters/HierarchyLocationFilter.tsx` | ‚ùå –£—Å—Ç–∞—Ä–µ–≤—à–∏–π | –£–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ |

---

### Backend: backend/app/

#### –§–∞–π–ª—ã —Å `settlement_id`

| –§–∞–π–ª | –ü—Ä–∏—á–∏–Ω–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –î–µ–π—Å—Ç–≤–∏–µ |
|------|---------|-----------|----------|
| `models/listing.py` | –ü–æ–ª–µ `Listing.settlement_id` | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π | –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö ‚Üí `location_id` |
| `routers/listings.py` | –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤ API | üî¥ –í—ã—Å–æ–∫–∏–π | –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å –Ω–∞ `location_id` |
| `routers/public_plots.py` | Fallback —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è | üü° –°—Ä–µ–¥–Ω–∏–π | –£–¥–∞–ª–∏—Ç—å fallback |
| `routers/admin_listings.py` | CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ | üî¥ –í—ã—Å–æ–∫–∏–π | –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å |
| `routers/locations.py` | `/resolve` endpoint | üü¢ –ù–∏–∑–∫–∏–π | –û—Å—Ç–∞–≤–∏—Ç—å –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ |
| `schemas/admin_listing.py` | Pydantic —Å—Ö–µ–º—ã | üî¥ –í—ã—Å–æ–∫–∏–π | –£–¥–∞–ª–∏—Ç—å `settlement_id` |
| `scripts/*.py` | –ú–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã | üü¢ –ù–∏–∑–∫–∏–π | –ú–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å |

---

### Admin: admin/src/

| –§–∞–π–ª | –ü—Ä–∏—á–∏–Ω–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –î–µ–π—Å—Ç–≤–∏–µ |
|------|---------|-----------|----------|
| `lib/api.ts` | API –∫–ª–∏–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `settlement_id` | üî¥ –í—ã—Å–æ–∫–∏–π | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ –æ–±–Ω–æ–≤–∏—Ç—å –µ—Å–ª–∏ –Ω—É–∂–Ω–æ |

---

## üìù –ü–æ—Ä—è–¥–æ–∫ –º–∏–≥—Ä–∞—Ü–∏–∏

### –≠—Ç–∞–ø 1: Backend (–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π)

1. [ ] **`models/listing.py`** ‚Äî –î–æ–±–∞–≤–∏—Ç—å `location_id` –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–µ –ø–æ–ª–µ, –µ—Å–ª–∏ –µ—â—ë –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ
2. [ ] **–ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** ‚Äî –°–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è `location_id` –∏–∑ `settlement_id`
3. [ ] **`routers/listings.py`** ‚Äî –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `location_id` –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä
4. [ ] **`routers/admin_listings.py`** ‚Äî CRUD —á–µ—Ä–µ–∑ `location_id`
5. [ ] **`schemas/admin_listing.py`** ‚Äî –£–¥–∞–ª–∏—Ç—å `settlement_id`, –æ—Å—Ç–∞–≤–∏—Ç—å `location_id`

### –≠—Ç–∞–ø 2: Frontend

1. [ ] **–£–¥–∞–ª–∏—Ç—å fallback –ª–æ–≥–∏–∫—É** –≤ `CatalogContent.tsx` (settlement_id/district_id)
2. [ ] **–£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏** –≤ `lib/geoUrl.ts` 
3. [ ] **–£–¥–∞–ª–∏—Ç—å `ResolvedLocation` –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ `ResolvedLocationNew`
4. [ ] **–£–¥–∞–ª–∏—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**:
   - `components/filters/LocationFilter.tsx`
   - `components/filters/HierarchyLocationFilter.tsx`

### –≠—Ç–∞–ø 3: Cleanup

1. [ ] **–£–¥–∞–ª–∏—Ç—å —Ç–∞–±–ª–∏—Ü—ã** `District` –∏ `Settlement` (–ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö)
2. [ ] **–£–¥–∞–ª–∏—Ç—å –º–æ–¥–µ–ª–∏** `District`, `Settlement` –∏–∑ backend
3. [ ] **–£–¥–∞–ª–∏—Ç—å `/resolve` endpoint** (—Å—Ç–∞—Ä—ã–π), –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ `/resolve-new` –∏ `/resolve-v2`

---

## üîç –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

```bash
# –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è —Å—Ç–∞—Ä–æ–π —Å–∏—Å—Ç–µ–º—ã

# Frontend
grep -rn "settlement_id" kaliningrad-land/src/ --include="*.tsx" --include="*.ts"
grep -rn "district_id" kaliningrad-land/src/ --include="*.tsx" --include="*.ts"
grep -rn "settlements=" kaliningrad-land/src/ --include="*.tsx" --include="*.ts"
grep -rn "LocationFilter" kaliningrad-land/src/ --include="*.tsx"
grep -rn "from.*Settlement" kaliningrad-land/src/ --include="*.tsx" --include="*.ts"

# Backend
grep -rn "settlement_id" backend/app/ --include="*.py"
grep -rn "district_id" backend/app/ --include="*.py"
grep -rn "Settlement\." backend/app/ --include="*.py"
grep -rn "District\." backend/app/ --include="*.py"

# Admin
grep -rn "settlement_id" admin/src/ --include="*.tsx" --include="*.ts"
```

---

## üìö –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫: –ù–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –ª–æ–∫–∞—Ü–∏–π

### –¢–∞–±–ª–∏—Ü–∞ `locations`

```sql
CREATE TABLE locations (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    slug VARCHAR(255) NOT NULL,
    type VARCHAR(50) NOT NULL,  -- 'region', 'city', 'district', 'settlement'
    settlement_type VARCHAR(20),  -- '–≥', '–ø–æ—Å', '–ø', '—Å' –∏ —Ç.–¥.
    parent_id INTEGER REFERENCES locations(id),
    sort_order INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT NOW()
);
```

### –ò–µ—Ä–∞—Ä—Ö–∏—è

```
–ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å (region, id=1)
‚îú‚îÄ‚îÄ –≥. –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥ (city, parent_id=1)
‚îú‚îÄ‚îÄ –ó–µ–ª–µ–Ω–æ–≥—Ä–∞–¥—Å–∫–∏–π —Ä-–Ω (district, parent_id=1)
‚îÇ   ‚îú‚îÄ‚îÄ –ø. –°–≤–µ—Ç–ª–æ–≥–æ—Ä—Å–∫ (settlement, parent_id=X)
‚îÇ   ‚îî‚îÄ‚îÄ –ø–æ—Å. –û—Ç—Ä–∞–¥–Ω–æ–µ (settlement, parent_id=X)
‚îî‚îÄ‚îÄ –ì—É—Ä—å–µ–≤—Å–∫–∏–π —Ä-–Ω (district, parent_id=1)
    ‚îú‚îÄ‚îÄ –ø. –ê–≤–∞–Ω–≥–∞—Ä–¥–Ω–æ–µ (settlement, parent_id=Y)
    ‚îî‚îÄ‚îÄ ...
```

### API Endpoints

| Endpoint | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|----------|------------|
| `GET /api/locations/search?q=...` | –ü–æ–∏—Å–∫ –ª–æ–∫–∞—Ü–∏–π |
| `GET /api/locations/hierarchy/` | –ò–µ—Ä–∞—Ä—Ö–∏—è –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ |
| `GET /api/locations/{id}` | –ü–æ–ª—É—á–∏—Ç—å –ª–æ–∫–∞—Ü–∏—é –ø–æ ID |
| `GET /api/locations/resolve-new?slugs=...` | –†–µ–∑–æ–ª–≤ —Ü–µ–ø–æ—á–∫–∏ slugs (SSR) |
| `GET /api/locations/resolve-v2?slugs=...` | –†–µ–∑–æ–ª–≤ –¥–ª—è SmartLocationFilter |

### –§–æ—Ä–º–∞—Ç GeoLocation

```typescript
interface GeoLocation {
    // –ù–æ–≤–∞—è —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
    locationId?: number;
    
    // –î–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ (–±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–æ)
    districtId?: number;
    districtSlug?: string;
    districtName?: string;
    settlementId?: number;
    settlementSlug?: string;
    settlementName?: string;
    settlementType?: string;
}
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **Slugs –æ—Ç–ª–∏—á–∞—é—Ç—Å—è!** –°—Ç–∞—Ä–∞—è —Ç–∞–±–ª–∏—Ü–∞ `District` –∏–º–µ–µ—Ç slug `gur-evskij-r-n`, –Ω–æ–≤–∞—è `locations` ‚Äî `gur'evskij-r-n` (–∞–ø–æ—Å—Ç—Ä–æ—Ñ –¥–ª—è –º—è–≥–∫–æ–≥–æ –∑–Ω–∞–∫–∞)

2. **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å URL** ‚Äî —Å—Ç–∞—Ä—ã–µ URL —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ slugs –º–æ–≥—É—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å. –ù—É–∂–µ–Ω 301 —Ä–µ–¥–∏—Ä–µ–∫—Ç –∏–ª–∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤ `resolve-new`

3. **Listings –∏–º–µ—é—Ç –æ–±–∞ –ø–æ–ª—è** ‚Äî `settlement_id` (—Å—Ç–∞—Ä–æ–µ) –∏ `location_id` (–Ω–æ–≤–æ–µ). –ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ `settlement_id` —Å—Ç–∞–Ω–µ—Ç deprecated

4. **–ì–æ—Ä–æ–¥–∞ –±–µ–∑ district** ‚Äî –≥. –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥ —ç—Ç–æ `city` –Ω–∞–ø—Ä—è–º—É—é –ø–æ–¥ —Ä–µ–≥–∏–æ–Ω–æ–º, –Ω–µ –ø–æ–¥ —Ä–∞–π–æ–Ω–æ–º
